# SL Makefile
#
# Copyright (C) 2007-2016 Devaev Maxim
# See file "LICENSE" for details
#
# @configure_input@
#
#####


CC=@CC_PROG@
CFLAGS=@CFLAGS@
MKDIR=@MKDIR_PROG@
INS=@INSTALL@
RM=@RM_PROG@
CHMOD=@CHMOD_PROG@

SL_SRC=src/help.c src/linear_index.c src/main.c src/managed_search.c src/manager.c \
	src/options.c src/search.c src/search_output.c src/settings.c src/string.c
SL_OBJ=src/help.o src/linear_index.o src/main.o src/managed_search.o src/manager.o \
	src/options.o src/search.o src/search_output.o src/settings.o src/string.o
SL_CONFIG=src/config.h
SL_PROG=sl

INS_SL_PROG_DIR=@bindir@
INS_SL_SHARES_DIR=@datarootdir@/sl
INS_SL_DICTS_DIR=$(INS_SL_SHARES_DIR)/dicts
INS_SL_SOUNDS_DIR=$(INS_SL_SHARES_DIR)/sounds

#####
.SUFFIXES : .o .c

.c.o :
	$(CC) -c $(CFLAGS) -o "$@" "$<"

#####
all : $(SL_OBJ)
	$(CC) $(LDFLAGS) -o $(SL_PROG) $(SL_OBJ)

install :
	$(MKDIR) -p $(DESTDIR)$(INS_SL_PROG_DIR)
	$(MKDIR) -p $(DESTDIR)$(INS_SL_DICTS_DIR)
	$(MKDIR) -p $(DESTDIR)$(INS_SL_SOUNDS_DIR)
	-$(CHMOD) 777 $(DESTDIR)$(INS_SL_DICTS_DIR)
	-$(CHMOD) +t $(DESTDIR)$(INS_SL_DICTS_DIR)
	-$(CHMOD) 777 $(DESTDIR)$(INS_SL_SOUNDS_DIR)
	-$(CHMOD) +t $(DESTDIR)$(INS_SL_SOUNDS_DIR)
	$(INS) $(SL_PROG) $(DESTDIR)$(INS_SL_PROG_DIR)

uninstall :
	$(RM) -f $(DESTDIR)$(INS_SL_PROG_DIR)/$(SL_PROG)
	$(RM) -rf $(DESTDIR)$(INS_SL_SHARES_DIR)

clean :
	$(RM) -f $(SL_PROG) $(SL_OBJ) $(SL_CONFIG)

