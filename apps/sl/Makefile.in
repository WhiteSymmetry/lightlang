# SL Makefile
# @configure_input@
# Copyright (C) 2007-2016 Devaev Maxim
# See file "LICENSE" for details
##

CC=@CC_PROG@
CFLAGS=@CFLAGS@
MKDIR=@MKDIR_PROG@
CP=@CP_PROG@
INS=@INSTALL@
LN=@LN_PROG@
RM=@RM_PROG@
PWD=@PWD_PROG@
CHMOD=@CHMOD_PROG@

SL_SRC=src/main.c \
	src/manager.c \
	src/mstring.c \
	src/settings.c \
	src/find.c \
	src/info.c
SL_OBJ=src/main.o \
	src/manager.o \
	src/mstring.o \
	src/settings.o \
	src/find.o \
	src/info.o
SL_CONFIG=src/config.h
SL_PROG=sl

INS_SL_PROG_DIR=@prefix@/bin
INS_SL_SHARES_DIR=@prefix@/share/sl
INS_SL_DICTS_DIR=@prefix@/share/sl/dicts
INS_SL_SOUNDS_DIR=@prefix@/share/sl/sounds

#####
.SUFFIXES : .o .c

.c.o :
	$(CC) -c $(CFLAGS) -o "$@" "$<"

#####
all : $(SL_OBJ)
	$(CC) $(LDFLAGS) -o $(SL_PROG) $(SL_OBJ)
	-$(LN) -s `$(PWD)`/$(SL_PROG) ../../$(SL_PROG)

install :
	$(MKDIR) -p $(DESTDIR)$(INS_SL_PROG_DIR)
	$(MKDIR) -p $(DESTDIR)$(INS_SL_DICTS_DIR)
	$(MKDIR) -p $(DESTDIR)$(INS_SL_SOUNDS_DIR)
	-$(CHMOD) 777 $(DESTDIR)$(INS_SL_DICTS_DIR)
	-$(CHMOD) 777 $(DESTDIR)$(INS_SL_SOUNDS_DIR)
	$(INS) $(SL_PROG) $(DESTDIR)$(INS_SL_PROG_DIR)

uninstall :
	$(RM) -f $(DESTDIR)$(INS_SL_PROG_DIR)/$(SL_PROG)
	$(RM) -rf $(DESTDIR)$(INS_SL_SHARES_DIR)

clean :
	$(RM) -f $(SL_PROG) $(SL_OBJ) $(SL_CONFIG)
	-$(RM) -f ../../$(SL_PROG)

