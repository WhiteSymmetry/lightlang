# SL Makefile
#
# Copyright (C) 2007-2016 Devaev Maxim
# See file "LICENSE" for details
#
# @configure_input@
#
#####


CC = @CC_PROG@
CFLAGS = @CFLAGS@
MKDIR = @MKDIR_PROG@
INS = @INSTALL@
RM = @RM_PROG@
CHMOD = @CHMOD_PROG@

SL_SRC_DIR = src
SL_SRC = $(shell ls $(SL_SRC_DIR)/*.c)
SL_OBJ = $(SL_SRC:.c=.o)
SL_CONFIG = $(SL_SRC_DIR)/config.h
SL_PROG = sl

INS_SL_PROG_DIR = @bindir@
INS_SL_SHARES_DIR = @datarootdir@/sl
INS_SL_DICTS_DIR = $(INS_SL_SHARES_DIR)/dicts
INS_SL_SOUNDS_DIR = $(INS_SL_SHARES_DIR)/sounds


##### Targets #####

.SUFFIXES : .o .c

.c.o :
	$(CC) -c $(CFLAGS) -o "$@" "$<"


all : $(SL_OBJ)
	$(CC) $(LDFLAGS) -o $(SL_PROG) $(SL_OBJ)

install :
	$(MKDIR) -p $(DESTDIR)$(INS_SL_PROG_DIR)
	$(MKDIR) -p $(DESTDIR)$(INS_SL_DICTS_DIR)
	$(MKDIR) -p $(DESTDIR)$(INS_SL_SOUNDS_DIR)
	-$(CHMOD) 777 $(DESTDIR)$(INS_SL_DICTS_DIR)
	-$(CHMOD) +t $(DESTDIR)$(INS_SL_DICTS_DIR)
	-$(CHMOD) 777 $(DESTDIR)$(INS_SL_SOUNDS_DIR)
	-$(CHMOD) +t $(DESTDIR)$(INS_SL_SOUNDS_DIR)
	$(INS) $(SL_PROG) $(DESTDIR)$(INS_SL_PROG_DIR)

uninstall :
	$(RM) -f $(DESTDIR)$(INS_SL_PROG_DIR)/$(SL_PROG)
	$(RM) -rf $(DESTDIR)$(INS_SL_SHARES_DIR)

clean :
	$(RM) -f $(SL_PROG) $(SL_OBJ) $(SL_CONFIG)


.PHONY : all install uninstall clean

