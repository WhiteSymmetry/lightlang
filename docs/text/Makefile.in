# Text-documentation Makefile
#
# Copyright (C) 2007-2016 Devaev Maxim
# See file "LICENSE" for details
#
# @configure_input@
#
#####


MAKE=@MAKE_PROG@
CD=@CD_PROG@

EN_DIR=en
RU_DIR=ru

#####
install :
	$(CD) $(EN_DIR) && $(MAKE) install
	$(CD) $(RU_DIR) && $(MAKE) install

uninstall :
	$(CD) $(EN_DIR) && $(MAKE) uninstall
	$(CD) $(RU_DIR) && $(MAKE) uninstall

_create_ru_texts :
	echo > ru/text/README
	for file in "common_introduction.html" "common_new_features.html" \
		"common_installation_and_configuration.html" "common_authors.html"; do \
		iconv -f utf-8 -t koi8-r ../html/ru/html/$$file | html2text -nobs | \
			iconv -f koi8-r -t utf-8 >> ru/text/README; \
		echo >> ru/text/README; \
	done
	iconv -f utf-8 -t koi8-r ../html/ru/html/common_installation_and_configuration.html \
		| html2text -nobs | iconv -f koi8-r -t utf-8 > ru/text/INSTALL
	iconv -f utf-8 -t koi8-r ../html/ru/html/common_new_features.html \
		| html2text -nobs | iconv -f koi8-r -t utf-8 1> ru/text/VERSION

_create_en_texts :
	echo > en/text/README
	for file in "common_introduction.html" "common_new_features.html" \
		"common_installation_and_configuration.html" "common_authors.html"; do \
		iconv -f utf-8 -t koi8-r ../html/en/html/$$file | html2text -nobs | \
			iconv -f koi8-r -t utf-8 >> en/text/README; \
		echo >> en/text/README; \
	done
	iconv -f utf-8 -t koi8-r ../html/en/html/common_installation_and_configuration.html \
		| html2text -nobs | iconv -f koi8-r -t utf-8 > en/text/INSTALL
	iconv -f utf-8 -t koi8-r ../html/en/html/common_new_features.html \
		| html2text -nobs | iconv -f koi8-r -t utf-8 1> en/text/VERSION

