# Dictionaries Makefile
#
# Copyright (C) 2007-2016 Devaev Maxim
# See file "LICENSE" for details
#
# @configure_input@
#
#####


MKDIR=@MKDIR_PROG@
CP=@CP_PROG@
RM=@RM_PROG@
CAT=@CAT_PROG@
LS=@LS_PROG@
CHMOD=@CHMOD_PROG@
SL=../../apps/sl/sl

TMP_FILE=/tmp/tmpdict

DICTS_SRC_DIR=src
DICTS_DIR=dicts

INS_DICTS_DIR=@datarootdir@/sl/dicts

#####
all :
	for file in `$(LS) $(DICTS_SRC_DIR)/*.??-??`; do \
		$(SL) --print-index $$file 1> $(TMP_FILE) && \
		$(CAT) $$file 1>> $(TMP_FILE) && \
		$(SL) --print-index $(TMP_FILE) 1> $(DICTS_DIR)/$${file##$(DICTS_SRC_DIR)/} && \
		$(CAT) $$file 1>> $(DICTS_DIR)/$${file##$(DICTS_SRC_DIR)/}; \
	done
	$(RM) -f $(TMP_FILE)

install :
	$(MKDIR) -p $(DESTDIR)$(INS_DICTS_DIR)
	-$(CHMOD) 777 $(DESTDIR)$(INS_DICTS_DIR)
	-$(CP) -f $(DICTS_DIR)/*.??-?? $(DESTDIR)$(INS_DICTS_DIR)

uninstall :
	$(RM) -rf $(DESTDIR)$(INS_DICTS_DIR)

clean :
	$(RM) -f $(DICTS_DIR)/*.??-??

