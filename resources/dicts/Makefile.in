# Dictionaries Makefile
#
# Copyright (C) 2007-2016 Devaev Maxim
# See file "LICENSE" for details
#
# @configure_input@
#
#####


MKDIR = @MKDIR_PROG@
CP = @CP_PROG@
RM = @RM_PROG@
CAT = @CAT_PROG@
CD = @CD_PROG@
LS = @LS_PROG@
CHMOD = @CHMOD_PROG@
MKTEMP = @MKTEMP_PROG@
SL = ../../apps/sl/sl

DICTS_SRC_DIR = src
DICTS_DIR = dicts

INS_DICTS_DIR = @datarootdir@/sl/dicts


##### Targets #####

all :
	-tmp_file=`$(MKTEMP)`; \
	$(CD) $(DICTS_SRC_DIR) && for file in `$(LS) *.??-??`; do \
		$(SL) --print-index $$file 1> $$tmp_file && \
		$(CAT) $$file 1>> $$tmp_file && \
		$(SL) --print-index $$tmp_file 1> $(DICTS_DIR)/$${file##$(DICTS_SRC_DIR)/} && \
		$(CAT) $$file 1>> $(DICTS_DIR)/$${file##$(DICTS_SRC_DIR)/}; \
	done; \
	$(RM) -f $$tmp_file

install :
	$(MKDIR) -p $(DESTDIR)$(INS_DICTS_DIR)
	-$(CHMOD) 777 $(DESTDIR)$(INS_DICTS_DIR)
	-$(CHMOD) +t $(DESTDIR)$(INS_DICTS_DIR)
	-$(CP) -f $(DICTS_DIR)/*.??-?? $(DESTDIR)$(INS_DICTS_DIR)

uninstall :
	$(RM) -rf $(DESTDIR)$(INS_DICTS_DIR)

clean :
	$(RM) -f $(DICTS_DIR)/*.??-??


.PHONY : all install uninstall clean

